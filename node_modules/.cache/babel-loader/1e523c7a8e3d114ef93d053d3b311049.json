{"ast":null,"code":"var _jsxFileName = \"D:\\\\Development\\\\portfolio-projects\\\\e-commerce-practice\\\\frontend\\\\src\\\\components\\\\screens\\\\OrderScreen.jsx\";\n\n/* eslint-disable camelcase */\nimport React from 'react';\nimport { Link, useHistory, useParams } from 'react-router-dom';\nimport { Button, Row, Col, ListGroup, Image, Card } from 'react-bootstrap';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { FaDollarSign } from 'react-icons/fa';\nimport { uuid } from 'uuidv4';\nimport Message from '../Message';\nimport CheckoutSteps from '../CheckoutSteps';\nimport { createOrder } from '../../actions/orderActions';\nimport { resetCartItems } from '../../actions/cartActions';\n\nconst OrderScreen = () => {\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const {\n    id\n  } = useParams();\n  const {\n    cartItems,\n    shippingAddress,\n    paymentMethod\n  } = useSelector(state => state.cart);\n  const {\n    firstname,\n    lastname\n  } = useSelector(state => state.userDetails.user);\n  const {\n    userInfo: {\n      user_id,\n      email\n    }\n  } = useSelector(state => state.userLogin); // TODO - CALCULATIONS FOR PRICE\n\n  const addDecimals = num => (Math.round(num * 100) / 100).toFixed(2);\n\n  const subTotalPrice = addDecimals(cartItems.reduce((accu, item) => accu + parseInt(item.price) * item.qty, 0));\n  const shippingPrice = addDecimals(subTotalPrice > 100 ? 0 : 100);\n  const taxPrice = addDecimals(Number((0.15 * subTotalPrice).toFixed(2)));\n  const totalPrice = (Number(subTotalPrice) + Number(shippingPrice) + Number(taxPrice)).toFixed(2);\n\n  const placeOrderHandler = e => {\n    e.preventDefault();\n    const order_id = uuid();\n    const orderItems = cartItems.map(item => ({\n      order_id,\n      product_id: item.product,\n      user_id,\n      quantity: item.qty,\n      payment_method: paymentMethod,\n      payment_email_address: email\n    }));\n    console.log('WTF', orderItems);\n    orderItems.forEach(item => {\n      dispatch(createOrder({\n        order_id: item.order_id,\n        product_id: item.product_id,\n        user_id: item.user_id,\n        quantity: item.quantity,\n        payment_method: item.payment_method,\n        payment_email_address: item.payment_email_address,\n        shipping_address: shippingAddress.address,\n        shipping_city: shippingAddress.city,\n        shipping_postal_code: shippingAddress.postalCode,\n        shipping_country: shippingAddress.country\n      }));\n    });\n    dispatch(resetCartItems());\n    history.push('/');\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Message, {\n    variant: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, \"ORDER \", id)), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 15\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }\n  }, \"Name:\"), '', firstname, \", \", lastname, \" \", ''), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 17\n    }\n  }, \"Address:\"), shippingAddress.address, \",\", shippingAddress.city, ' ', shippingAddress.postalCode, \" \", shippingAddress.country)), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 15\n    }\n  }, \"Payment Method\"), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 15\n    }\n  }, \"Method:\"), paymentMethod), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 15\n    }\n  }, \"Order List\"), cartItems.length === 0 ? /*#__PURE__*/React.createElement(Message, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }, \"Your cart is empty\") : /*#__PURE__*/React.createElement(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 17\n    }\n  }, cartItems.map(item => /*#__PURE__*/React.createElement(ListGroup.Item, {\n    key: item.product,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    md: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Image, {\n    src: item.image,\n    alt: item.name,\n    fluid: true,\n    rounded: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 27\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 25\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/product/<FaDollarSign />{item.product}\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 27\n    }\n  }, item.name)), /*#__PURE__*/React.createElement(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 25\n    }\n  }, item.qty, \" x \", /*#__PURE__*/React.createElement(FaDollarSign, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 40\n    }\n  }), item.price, \" = \", /*#__PURE__*/React.createElement(FaDollarSign, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 42\n    }\n  }), item.qty * item.price)))))))), /*#__PURE__*/React.createElement(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, \"Order Summary\")), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 19\n    }\n  }, \"Items\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(FaDollarSign, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 21\n    }\n  }), subTotalPrice))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 19\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(FaDollarSign, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }), shippingPrice))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 19\n    }\n  }, \"Tax\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(FaDollarSign, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 21\n    }\n  }), taxPrice))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 19\n    }\n  }, \"Total\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(FaDollarSign, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 21\n    }\n  }), totalPrice))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    type: \"button\",\n    className: \"btn-block\",\n    disabled: cartItems.lenght === 0,\n    onClick: placeOrderHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 17\n    }\n  }, \"Place Order\")))))));\n};\n\nexport default OrderScreen;","map":{"version":3,"sources":["D:/Development/portfolio-projects/e-commerce-practice/frontend/src/components/screens/OrderScreen.jsx"],"names":["React","Link","useHistory","useParams","Button","Row","Col","ListGroup","Image","Card","useDispatch","useSelector","FaDollarSign","uuid","Message","CheckoutSteps","createOrder","resetCartItems","OrderScreen","history","dispatch","id","cartItems","shippingAddress","paymentMethod","state","cart","firstname","lastname","userDetails","user","userInfo","user_id","email","userLogin","addDecimals","num","Math","round","toFixed","subTotalPrice","reduce","accu","item","parseInt","price","qty","shippingPrice","taxPrice","Number","totalPrice","placeOrderHandler","e","preventDefault","order_id","orderItems","map","product_id","product","quantity","payment_method","payment_email_address","console","log","forEach","shipping_address","address","shipping_city","city","shipping_postal_code","postalCode","shipping_country","country","push","length","image","name","lenght"],"mappings":";;AAAA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,IAAT,EAAeC,UAAf,EAA2BC,SAA3B,QAA4C,kBAA5C;AACA,SAASC,MAAT,EAAiBC,GAAjB,EAAsBC,GAAtB,EAA2BC,SAA3B,EAAsCC,KAAtC,EAA6CC,IAA7C,QAAyD,iBAAzD;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,YAAT,QAA6B,gBAA7B;AACA,SAASC,IAAT,QAAqB,QAArB;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,aAAP,MAA0B,kBAA1B;AACA,SAASC,WAAT,QAA4B,4BAA5B;AACA,SAASC,cAAT,QAA+B,2BAA/B;;AAEA,MAAMC,WAAW,GAAG,MAAM;AACxB,QAAMC,OAAO,GAAGjB,UAAU,EAA1B;AACA,QAAMkB,QAAQ,GAAGV,WAAW,EAA5B;AACA,QAAM;AAAEW,IAAAA;AAAF,MAASlB,SAAS,EAAxB;AACA,QAAM;AAAEmB,IAAAA,SAAF;AAAaC,IAAAA,eAAb;AAA8BC,IAAAA;AAA9B,MAAgDb,WAAW,CAC9Dc,KAAD,IAAWA,KAAK,CAACC,IAD8C,CAAjE;AAIA,QAAM;AAAEC,IAAAA,SAAF;AAAaC,IAAAA;AAAb,MAA0BjB,WAAW,CACxCc,KAAD,IAAWA,KAAK,CAACI,WAAN,CAAkBC,IADY,CAA3C;AAIA,QAAM;AACJC,IAAAA,QAAQ,EAAE;AAAEC,MAAAA,OAAF;AAAWC,MAAAA;AAAX;AADN,MAEFtB,WAAW,CAAEc,KAAD,IAAWA,KAAK,CAACS,SAAlB,CAFf,CAZwB,CAgBxB;;AAEA,QAAMC,WAAW,GAAIC,GAAD,IAAS,CAACC,IAAI,CAACC,KAAL,CAAWF,GAAG,GAAG,GAAjB,IAAwB,GAAzB,EAA8BG,OAA9B,CAAsC,CAAtC,CAA7B;;AAEA,QAAMC,aAAa,GAAGL,WAAW,CAC/Bb,SAAS,CAACmB,MAAV,CAAiB,CAACC,IAAD,EAAOC,IAAP,KAAgBD,IAAI,GAAGE,QAAQ,CAACD,IAAI,CAACE,KAAN,CAAR,GAAuBF,IAAI,CAACG,GAApE,EAAyE,CAAzE,CAD+B,CAAjC;AAGA,QAAMC,aAAa,GAAGZ,WAAW,CAACK,aAAa,GAAG,GAAhB,GAAsB,CAAtB,GAA0B,GAA3B,CAAjC;AACA,QAAMQ,QAAQ,GAAGb,WAAW,CAACc,MAAM,CAAC,CAAC,OAAOT,aAAR,EAAuBD,OAAvB,CAA+B,CAA/B,CAAD,CAAP,CAA5B;AAEA,QAAMW,UAAU,GAAG,CACjBD,MAAM,CAACT,aAAD,CAAN,GACAS,MAAM,CAACF,aAAD,CADN,GAEAE,MAAM,CAACD,QAAD,CAHW,EAIjBT,OAJiB,CAIT,CAJS,CAAnB;;AAMA,QAAMY,iBAAiB,GAAIC,CAAD,IAAO;AAC/BA,IAAAA,CAAC,CAACC,cAAF;AACA,UAAMC,QAAQ,GAAGzC,IAAI,EAArB;AAEA,UAAM0C,UAAU,GAAGjC,SAAS,CAACkC,GAAV,CAAeb,IAAD,KAAW;AAC1CW,MAAAA,QAD0C;AAE1CG,MAAAA,UAAU,EAAEd,IAAI,CAACe,OAFyB;AAG1C1B,MAAAA,OAH0C;AAI1C2B,MAAAA,QAAQ,EAAEhB,IAAI,CAACG,GAJ2B;AAK1Cc,MAAAA,cAAc,EAAEpC,aAL0B;AAM1CqC,MAAAA,qBAAqB,EAAE5B;AANmB,KAAX,CAAd,CAAnB;AAQA6B,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBR,UAAnB;AACAA,IAAAA,UAAU,CAACS,OAAX,CAAoBrB,IAAD,IAAU;AAC3BvB,MAAAA,QAAQ,CACNJ,WAAW,CAAC;AACVsC,QAAAA,QAAQ,EAAEX,IAAI,CAACW,QADL;AAEVG,QAAAA,UAAU,EAAEd,IAAI,CAACc,UAFP;AAGVzB,QAAAA,OAAO,EAAEW,IAAI,CAACX,OAHJ;AAIV2B,QAAAA,QAAQ,EAAEhB,IAAI,CAACgB,QAJL;AAKVC,QAAAA,cAAc,EAAEjB,IAAI,CAACiB,cALX;AAMVC,QAAAA,qBAAqB,EAAElB,IAAI,CAACkB,qBANlB;AAOVI,QAAAA,gBAAgB,EAAE1C,eAAe,CAAC2C,OAPxB;AAQVC,QAAAA,aAAa,EAAE5C,eAAe,CAAC6C,IARrB;AASVC,QAAAA,oBAAoB,EAAE9C,eAAe,CAAC+C,UAT5B;AAUVC,QAAAA,gBAAgB,EAAEhD,eAAe,CAACiD;AAVxB,OAAD,CADL,CAAR;AAcD,KAfD;AAiBApD,IAAAA,QAAQ,CAACH,cAAc,EAAf,CAAR;AACAE,IAAAA,OAAO,CAACsD,IAAR,CAAa,GAAb;AACD,GAhCD;;AAiCA,sBACE,uDACE,oBAAC,OAAD;AAAS,IAAA,OAAO,EAAC,MAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAAWpD,EAAX,CADF,CADF,eAIE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAK,IAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AAAW,IAAA,OAAO,EAAC,OAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,EAEG,EAFH,EAGGM,SAHH,QAGgBC,QAHhB,OAG2B,EAH3B,CAFF,eAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,EAEGL,eAAe,CAAC2C,OAFnB,OAE6B3C,eAAe,CAAC6C,IAF7C,EAEmD,GAFnD,EAGG7C,eAAe,CAAC+C,UAHnB,OAGgC/C,eAAe,CAACiD,OAHhD,CAPF,CADF,eAcE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAFF,EAGGhD,aAHH,CAdF,eAmBE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,EAEGF,SAAS,CAACoD,MAAV,KAAqB,CAArB,gBACC,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BADD,gBAGC,oBAAC,SAAD;AAAW,IAAA,OAAO,EAAC,OAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGpD,SAAS,CAACkC,GAAV,CAAeb,IAAD,iBACb,oBAAC,SAAD,CAAW,IAAX;AAAgB,IAAA,GAAG,EAAEA,IAAI,CAACe,OAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAK,IAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,KAAD;AACE,IAAA,GAAG,EAAEf,IAAI,CAACgC,KADZ;AAEE,IAAA,GAAG,EAAEhC,IAAI,CAACiC,IAFZ;AAGE,IAAA,KAAK,MAHP;AAIE,IAAA,OAAO,MAJT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADF,eASE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAM,IAAA,EAAE,EAAC,yCAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGjC,IAAI,CAACiC,IADR,CADF,CATF,eAcE,oBAAC,GAAD;AAAK,IAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGjC,IAAI,CAACG,GADR,sBACe,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADf,EAEGH,IAAI,CAACE,KAFR,sBAEiB,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFjB,EAGGF,IAAI,CAACG,GAAL,GAAWH,IAAI,CAACE,KAHnB,CAdF,CADF,CADD,CADH,CALJ,CAnBF,CADF,CADF,eAwDE,oBAAC,GAAD;AAAK,IAAA,EAAE,EAAE,CAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AAAW,IAAA,OAAO,EAAC,OAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADF,CADF,eAIE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEGL,aAFH,CAFF,CADF,CAJF,eAaE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEGO,aAFH,CAFF,CADF,CAbF,eAsBE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEGC,QAFH,CAFF,CADF,CAtBF,eA+BE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,eAEE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEGE,UAFH,CAFF,CADF,CA/BF,eAwCE,oBAAC,SAAD,CAAW,IAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AACE,IAAA,IAAI,EAAC,QADP;AAEE,IAAA,SAAS,EAAC,WAFZ;AAGE,IAAA,QAAQ,EAAE5B,SAAS,CAACuD,MAAV,KAAqB,CAHjC;AAIE,IAAA,OAAO,EAAE1B,iBAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBADF,CAxCF,CADF,CADF,CAxDF,CAJF,CADF;AAuHD,CAxLD;;AA0LA,eAAejC,WAAf","sourcesContent":["/* eslint-disable camelcase */\r\nimport React from 'react';\r\nimport { Link, useHistory, useParams } from 'react-router-dom';\r\nimport { Button, Row, Col, ListGroup, Image, Card } from 'react-bootstrap';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { FaDollarSign } from 'react-icons/fa';\r\nimport { uuid } from 'uuidv4';\r\nimport Message from '../Message';\r\nimport CheckoutSteps from '../CheckoutSteps';\r\nimport { createOrder } from '../../actions/orderActions';\r\nimport { resetCartItems } from '../../actions/cartActions';\r\n\r\nconst OrderScreen = () => {\r\n  const history = useHistory();\r\n  const dispatch = useDispatch();\r\n  const { id } = useParams();\r\n  const { cartItems, shippingAddress, paymentMethod } = useSelector(\r\n    (state) => state.cart\r\n  );\r\n\r\n  const { firstname, lastname } = useSelector(\r\n    (state) => state.userDetails.user\r\n  );\r\n\r\n  const {\r\n    userInfo: { user_id, email },\r\n  } = useSelector((state) => state.userLogin);\r\n\r\n  // TODO - CALCULATIONS FOR PRICE\r\n\r\n  const addDecimals = (num) => (Math.round(num * 100) / 100).toFixed(2);\r\n\r\n  const subTotalPrice = addDecimals(\r\n    cartItems.reduce((accu, item) => accu + parseInt(item.price) * item.qty, 0)\r\n  );\r\n  const shippingPrice = addDecimals(subTotalPrice > 100 ? 0 : 100);\r\n  const taxPrice = addDecimals(Number((0.15 * subTotalPrice).toFixed(2)));\r\n\r\n  const totalPrice = (\r\n    Number(subTotalPrice) +\r\n    Number(shippingPrice) +\r\n    Number(taxPrice)\r\n  ).toFixed(2);\r\n\r\n  const placeOrderHandler = (e) => {\r\n    e.preventDefault();\r\n    const order_id = uuid();\r\n\r\n    const orderItems = cartItems.map((item) => ({\r\n      order_id,\r\n      product_id: item.product,\r\n      user_id,\r\n      quantity: item.qty,\r\n      payment_method: paymentMethod,\r\n      payment_email_address: email,\r\n    }));\r\n    console.log('WTF', orderItems);\r\n    orderItems.forEach((item) => {\r\n      dispatch(\r\n        createOrder({\r\n          order_id: item.order_id,\r\n          product_id: item.product_id,\r\n          user_id: item.user_id,\r\n          quantity: item.quantity,\r\n          payment_method: item.payment_method,\r\n          payment_email_address: item.payment_email_address,\r\n          shipping_address: shippingAddress.address,\r\n          shipping_city: shippingAddress.city,\r\n          shipping_postal_code: shippingAddress.postalCode,\r\n          shipping_country: shippingAddress.country,\r\n        })\r\n      );\r\n    });\r\n\r\n    dispatch(resetCartItems());\r\n    history.push('/');\r\n  };\r\n  return (\r\n    <>\r\n      <Message variant=\"info\">\r\n        <h5>ORDER {id}</h5>\r\n      </Message>\r\n      <Row>\r\n        <Col md={8}>\r\n          <ListGroup variant=\"flush\">\r\n            <ListGroup.Item>\r\n              <h2>Shipping</h2>\r\n              <p>\r\n                <strong>Name:</strong>\r\n                {''}\r\n                {firstname}, {lastname} {''}\r\n              </p>\r\n              <p>\r\n                <strong>Address:</strong>\r\n                {shippingAddress.address},{shippingAddress.city}{' '}\r\n                {shippingAddress.postalCode} {shippingAddress.country}\r\n              </p>\r\n            </ListGroup.Item>\r\n            <ListGroup.Item>\r\n              <h2>Payment Method</h2>\r\n              <strong>Method:</strong>\r\n              {paymentMethod}\r\n            </ListGroup.Item>\r\n            <ListGroup.Item>\r\n              <h2>Order List</h2>\r\n              {cartItems.length === 0 ? (\r\n                <Message>Your cart is empty</Message>\r\n              ) : (\r\n                <ListGroup variant=\"flush\">\r\n                  {cartItems.map((item) => (\r\n                    <ListGroup.Item key={item.product}>\r\n                      <Row>\r\n                        <Col md={2}>\r\n                          <Image\r\n                            src={item.image}\r\n                            alt={item.name}\r\n                            fluid\r\n                            rounded\r\n                          />\r\n                        </Col>\r\n                        <Col>\r\n                          <Link to=\"/product/<FaDollarSign />{item.product}\">\r\n                            {item.name}\r\n                          </Link>\r\n                        </Col>\r\n                        <Col md={4}>\r\n                          {item.qty} x <FaDollarSign />\r\n                          {item.price} = <FaDollarSign />\r\n                          {item.qty * item.price}\r\n                        </Col>\r\n                      </Row>\r\n                    </ListGroup.Item>\r\n                  ))}\r\n                </ListGroup>\r\n              )}\r\n            </ListGroup.Item>\r\n          </ListGroup>\r\n        </Col>\r\n        <Col md={4}>\r\n          <Card>\r\n            <ListGroup variant=\"flush\">\r\n              <ListGroup.Item>\r\n                <h2>Order Summary</h2>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Col>Items</Col>\r\n                  <Col>\r\n                    <FaDollarSign />\r\n                    {subTotalPrice}\r\n                  </Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Col>Shipping</Col>\r\n                  <Col>\r\n                    <FaDollarSign />\r\n                    {shippingPrice}\r\n                  </Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Col>Tax</Col>\r\n                  <Col>\r\n                    <FaDollarSign />\r\n                    {taxPrice}\r\n                  </Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Row>\r\n                  <Col>Total</Col>\r\n                  <Col>\r\n                    <FaDollarSign />\r\n                    {totalPrice}\r\n                  </Col>\r\n                </Row>\r\n              </ListGroup.Item>\r\n              <ListGroup.Item>\r\n                <Button\r\n                  type=\"button\"\r\n                  className=\"btn-block\"\r\n                  disabled={cartItems.lenght === 0}\r\n                  onClick={placeOrderHandler}\r\n                >\r\n                  Place Order\r\n                </Button>\r\n              </ListGroup.Item>\r\n            </ListGroup>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OrderScreen;\r\n"]},"metadata":{},"sourceType":"module"}